<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Invoice Triska Kencana</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f4f4f4;
    }

    .invoice-container {
      background: white;
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      border-radius: 10px;
    }

    .header {
      text-align: center;
      margin-bottom: 20px;
    }

    .logo {
      max-width: 300px;
      height: auto;
    }

    .form-identitas input {
      margin-bottom: 5px;
      width: 95%;
    }

    .form-barang {
      margin: 15px 0;
    }

    .form-barang input,
    .form-barang select {
      margin-right: 5px;
      padding: 5px;
    }

    .invoice-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    .invoice-table th,
    .invoice-table td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }

    .total {
      margin-top: 15px;
      font-weight: bold;
      text-align: right;
    }

    .actions {
      text-align: right;
      margin-top: 15px;
    }

    .btn {
      background-color: #007bff;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
    }

    .print-text {
      display: none;
    }

   @media print {
  body {
    -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
  }

  input, select, button, .form-barang, .actions .btn {
    display: none !important;
  }

  .print-text {
    display: inline !important;
  }

  table.invoice-table,
  table.invoice-table th,
  table.invoice-table td {
    border: 1px solid #000 !important;
    border-collapse: collapse;
  }

  /* Logo tetap besar seperti di layar */
  .logo {
    max-width: 300px;
    height: auto;
  }
}
  </style>
</head>
<body>
  <div class="invoice-container" id="invoice">
    <div class="header" style="position: relative; align-items: center; justify-content: space-between;">
  <h1 class="logo-text" style="margin: 0; font-family: 'poppins' , sans-serif; font-size: 32px; font-weight: 600;">Kop Triska Kencana</h1>
  <img src="kop.jpeg" alt="Logo Triska Kencana" class="logo" style="position: absolute; right: 0; top: 0; height: 100px;">
</div>

    <p><strong>No. Invoice:</strong> <span id="nomor-invoice">INV-001</span></p>
    <p><strong>Tanggal:</strong> <span id="tanggal"></span></p>

    <table class="form-identitas">
      <tr>
        <td><strong>Nama:</strong></td>
        <td>
          <input type="text" id="inputNama" oninput="updatePreview()">
          <div class="print-text" id="previewNama"></div>
        </td>
      </tr>
      <tr>
        <td><strong>Alamat:</strong></td>
        <td>
          <input type="text" id="inputAlamat" oninput="updatePreview()">
          <div class="print-text" id="previewAlamat"></div>
        </td>
      </tr>
      <tr>
        <td><strong>No. Telp:</strong></td>
        <td>
          <input type="text" id="inputTelp" oninput="updatePreview()">
          <div class="print-text" id="previewTelp"></div>
        </td>
      </tr>
    </table>

    <div class="form-barang">
         <select id="barang">
        <option value="">-- Pilih Barang --</option>
        <option value="TENDA POLOS 4X6">TENDA POLOS 4X6</option>
        <option value="TENDA SEMI 4X6">TENDA SEMI 4X6</option>
        <option value="TENDA BALON 4X6">TENDA BALON 4X6</option>
        <option value="TENDA SKAK 4X6">TENDA SKAK 4X6</option>
        <option value="TENDA LAMPION 4X6">TENDA LAMPION 4X6</option>
        <option value="TENDA LAPIS 4X6">TENDA LAPIS 4X6</option>
        <option value="TENDA POLOS 6X6">TENDA POLOS 6X6</option>
        <option value="TENDA SEMI 6X6">TENDA SEMI 6X6</option>
        <option value="TENDA LAMPION 6X6">TENDA LAMPION 6X6</option>
        <option value="TENDA BALON 6X6">TENDA BALON 6X6</option>
        <option value="TENDA SKAK 6X6">TENDA SKAK 6X6</option>
        <option value="TENDA LAPIS 6X6">TENDA LAPIS 6X6</option>
        <option value="KURSI BIASA">KURSI BIASA</option>
        <option value="KURSI COVER">KURSI COVER</option>
        <option value="MEJA BIASA">MEJA BIASA</option>
        <option value="MEJA BULAT">MEJA BULAT</option>
        <option value="MEJA + GUBUKAN">MEJA + GUBUKAN</option>
        <option value="PIRING">PIRING</option>
        <option value="MANGKOK BAKSO">MANGKOK BAKSO</option>
        <option value="MANGKOK SOTO">MANGKOK SOTO</option>
        <option value="PANGGUNG 4 X 4">PANGGUNG 4 X 4</option>
        <option value="PANGGUNG 4 X 6">PANGGUNG 4 X 6</option>
        <option value="PANGGUNG 6 X 6">PANGGUNG 6 X 6</option>
        <option value="PANGGUNG 6 X 8">PANGGUNG 6 X 8</option>
        <option value="BLOWER BIASA">BLOWER BIASA</option>
        <option value="BLOWER AIR">BLOWER AIR</option>
        <option value="TIRAI 6 METER">TIRAI 6 METER</option>
        <option value="KARPET 1 METER">KARPET 1 METER</option>
      </select>
      <input type="number" id="jumlah" placeholder="Jumlah">
      <input type="number" id="harga" placeholder="Harga (Rp)">
      <button onclick="tambahBarang()">Tambah</button>
    </div>

    <div class="form-tambah-barang">
      <input type="text" id="barangBaru" placeholder="Nama Barang Baru">
      <input type="number" id="hargaBaru" placeholder="Harga Barang (Rp)">
      <button onclick="tambahBarangBaru()">Tambah Barang Baru</button>
    </div>

    <table class="invoice-table">
      <thead>
        <tr>
          <th>No</th>
          <th>Nama Barang</th>
          <th>Jumlah</th>
          <th>Harga</th>
          <th>Total</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody id="tabel-barang"></tbody>
    </table>

    <div class="total" id="total-akhir">TOTAL: Rp -</div>

    <div class="actions">
      <button class="btn" onclick="cetakInvoice()">Cetak</button>
    </div>
  </div>

  <script>
    const hargaDefault = {
      "TENDA POLOS 4X6": 300000,
      "TENDA SEMI 4X6": 400000,
      "TENDA BALON 4X6": 600000,
      "TENDA SKAK 4X6": 750000,
      "TENDA LAMPION 4X6": 800000,
      "TENDA LAPIS 4X6": 850000,
      "TENDA POLOS 6X6": 400000,
      "TENDA SEMI 6X6": 900000,
      "TENDA LAMPION 6X6": 1200000,
      "TENDA BALON 6X6": 1200000,
      "TENDA SKAK 6X6": 1000000,
      "TENDA LAPIS 6X6": 950000,
      "KURSI BIASA": 3500,
      "KURSI COVER": 6000,
      "MEJA BIASA": 50000,
      "MEJA BULAT": 55000,
      "MEJA + GUBUKAN": 100000,
      "PIRING": 75000,
      "MANGKOK BAKSO": 75000,
      "MANGKOK SOTO": 75000,
      "PANGGUNG 4 X 4": 700000,
      "PANGGUNG 4 X 6": 1000000,
      "PANGGUNG 6 X 6": 1100000,
      "PANGGUNG 6 X 8": 1600000,
      "BLOWER BIASA": 300000,
      "BLOWER AIR": 350000,
      "TIRAI 6 METER": 150000,
      "KARPET 1 METER": 10000
    };

const today = new Date();
document.getElementById("tanggal").textContent = today.toLocaleDateString("id-ID");

// Ambil nomor invoice terakhir dari LocalStorage
let lastInvoiceNumber = localStorage.getItem("lastInvoiceNumber");
if (!lastInvoiceNumber) {
  lastInvoiceNumber = 1;
} else {
  lastInvoiceNumber = parseInt(lastInvoiceNumber) + 1;
}

// Simpan kembali nomor terbaru ke LocalStorage
localStorage.setItem("lastInvoiceNumber", lastInvoiceNumber);

// Format nomor invoice (3 digit, misal: 001, 002)
const formattedInvoice = "INV-" + String(lastInvoiceNumber).padStart(3, "0");
document.getElementById("nomor-invoice").textContent = formattedInvoice;



    let dataBarang = [];

    document.getElementById("barang").addEventListener("change", function () {
      const barang = this.value;
      document.getElementById("harga").value = hargaDefault[barang] || "";
    });

    function tambahBarang() {
      const barang = document.getElementById("barang").value;
      const jumlah = parseInt(document.getElementById("jumlah").value);
      const harga = parseInt(document.getElementById("harga").value);

      if (!barang || isNaN(jumlah) || isNaN(harga)) {
        alert("Mohon isi semua kolom!");
        return;
      }

      const total = jumlah * harga;
      dataBarang.push({ barang, jumlah, harga, total });
      renderTabel();
      resetForm();
    }
        function tambahBarangBaru() {
      const namaBaru = document.getElementById("barangBaru").value.trim();
      const hargaBaru = parseInt(document.getElementById("hargaBaru").value);

      if (!namaBaru || isNaN(hargaBaru) || hargaBaru <= 0) {
        alert("Nama dan harga barang harus diisi dengan benar!");
        return;
      }

      const barangSelect = document.getElementById("barang");
      const option = document.createElement("option");
      option.text = namaBaru;
      option.value = namaBaru;
      barangSelect.appendChild(option);

      hargaDefault[namaBaru] = hargaBaru;

      document.getElementById("barangBaru").value = "";
      document.getElementById("hargaBaru").value = "";

      alert(`Barang "${namaBaru}" berhasil ditambahkan.`);
    }

    function hapusBarang(index) {
      dataBarang.splice(index, 1);
      renderTabel();
    }

    function renderTabel() {
      const tbody = document.getElementById("tabel-barang");
      tbody.innerHTML = "";
      let totalAkhir = 0;

      dataBarang.forEach((item, index) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${index + 1}</td>
          <td>${item.barang}</td>
          <td>${item.jumlah}</td>
          <td>
            <input type="number" value="${item.harga}" onchange="updateHarga(${index}, this.value)" style="width: 100px;">
            <div class="print-text">Rp ${item.harga.toLocaleString('id-ID')}</div>
          </td>
          <td id="total-${index}">Rp ${item.total.toLocaleString('id-ID')}</td>
          <td><button class="hapus-btn" onclick="hapusBarang(${index})">Hapus</button></td>
        `;
        tbody.appendChild(tr);
        totalAkhir += item.total;
      });

      document.getElementById("total-akhir").textContent = "TOTAL: Rp " + totalAkhir.toLocaleString('id-ID');
    }

    function updateHarga(index, newHarga) {
      newHarga = parseInt(newHarga) || 0;
      dataBarang[index].harga = newHarga;
      dataBarang[index].total = newHarga * dataBarang[index].jumlah;

      document.getElementById(`total-${index}`).textContent = "Rp " + dataBarang[index].total.toLocaleString('id-ID');

      const baris = document.querySelectorAll("#tabel-barang tr")[index];
      const printText = baris.querySelector(".print-text");
      if (printText) {
        printText.textContent = "Rp " + newHarga.toLocaleString('id-ID');
      }

      let totalAkhir = dataBarang.reduce((sum, item) => sum + item.total, 0);
      document.getElementById("total-akhir").textContent = "TOTAL: Rp " + totalAkhir.toLocaleString('id-ID');
    }

    function resetForm() {
      document.getElementById("barang").value = "";
      document.getElementById("jumlah").value = "";
      document.getElementById("harga").value = "";
    }

    function cetakInvoice() {
      updatePreview();
      setTimeout(() => window.print(), 100);
    }

    function updatePreview() {
      document.getElementById("previewNama").textContent = document.getElementById("inputNama").value || "-";
      document.getElementById("previewAlamat").textContent = document.getElementById("inputAlamat").value || "-";
      document.getElementById("previewTelp").textContent = document.getElementById("inputTelp").value || "-";
    }
  </script>
</body>
</html>
